#
# define display information
#
name: Correlate Amplicon Values with Continous Sample Metadata

tooltip: |
    Filter amplicons or pool them by taxonomy, then correlate with sample metadata

screenshots: []

icon: icon.png

#
# define a set of similar apps that might be useful to the user
#
suggestions:
    apps:
        related:
            [app1, app2]
        next:
            [app3, app4]

#
# Configure the display and description of parameters
#
parameters : 
    amp_mat_upa :
        ui-name : |
            AmpliconMatrix
        short-hint : | 
            <code>AmpliconMatrix</code> with table of amplicon abundance or transformed abundance data
    sample_metadata :
        ui-name: |
            Sample metadata
        short-hint: |
            Column <code>AttributeMapping</code>'s attribute containing sample metadata to perform OTU correlation against
    tax_rank :
        ui-name : |
            Pool by<br>taxonomic rank
        short-hint : | 
            Pool OTUs based on this taxonomic rank. Default, leaving blank and value of <code>None</code>, is to not do anything 
    tax_field:
        ui-name: |
            Taxonomy field
        short-hint: |
            Row <code>AttributeMapping</code>'s attribute containing amplicons' taxonomy assignments. This is required in order to use preceding taxonomic rank parameter 
    abund_cutoff:
        ui-name : |
            [Transformed] abundance cutoff
        short-hint : | 
            Filter out OTUs that do not meet this threshold in at least one sample. Default is 1st quartile
    sd_cutoff:
        ui-name : |
            Standard deviation cutoff
        short-hint : | 
            Filter out OTUs that do not meet this abundance standard deviation threshold. Default is 1st quartile
    cor_cutoff:
        ui-name : |
            Correlation cutoff
        short-hint : | 
            Filter out OTU's that do not correlate with sample metadata with an absolute value of at least this amount. Default is <code>0.5</code>
    cor_method:
        ui-name : |
            Correlation method
        short-hint : | 
            Correlation method
    p_adj_method:
        ui-name : |
            Multiple testing<br>adjustment method
        short-hint : | 
            Multiple hypothesis testing p-value adjustment method
    p_adj_cutoff:
        ui-name : |
            Adjusted<br>p-value cutoff
        short-hint : | 
            Adjusted p-value cutoff

parameter-groups:
    amp_reduce_params:
        ui-name : |
            Amplicon pooling and filtering
        short-hint : |
            Reduce the number of amplicons to correlate against sample metadata
    cor_params:
        ui-name : |
            Correlation
        short-hint: |
            Select OTUs based on correlation and p-value


description : |

    <!--------------------------------------------------------------------------------------------->
    <h2>
    App Behavior
    </h2>

    <p>
    <b>This app is still prototypical!</b> 
    Currently it aims to cover 'happy paths'. 
    </p>

    <p>
    This app requires an input <code>AmpliconMatrix</code> with a column <code>AttributeMapping</code>
    containing the sample metadata to correlate amplicons' values against.
    If that <code>AmpliconMatrix</code> also has a row <code>AttributeMapping</code> containing taxonomy assignments,
    then pooling amplicons by taxonomy can be done.
    </p>

    <p>
    This app requires a sample metadata field with values with a minimum of 5, non-missing values.
    'Missing' values are represented by null, 'None', '', etc. (?), where a number usually is.
    </p>

    <p>
    This app expects "canonical" or near "canonical" taxonomy strings in order to pool amplicons by taxonomy well.
    In this case, that means taxonomies with assignments in the domain, phylum, class, order, family, genus, and species ranks.
    The ranks in the row AttributeMapping's taxonomy strings should be semicolon delimited.
    Incomplete ranks is accepted.
    In the case of collapsing amplicons by taxonomy where a rank is missing, missing ranks will be considered the same taxon.
    To obtain suitable taxonomic assignments, the RDP Classifier app can be run. 
    </p>

    <p>
    Possibly upcoming features: 
    (1) Choosing the cutoffs by quantile as well as by value via checkboxes in the UI, 
    (2) other cutoffs such as frequency. 
    Some features are left off because of dev/time resources.
    </p>

    <!--------------------------------------------------------------------------------------------->
    <h2>
    Acknowledgement
    </h2>

    <p>
    Special thanks to P. Weisenhorn for proposing this app and essential feedback,
    and thanks to K. Dill-McFarland for  
    <a href="https://rstudio-pubs-static.s3.amazonaws.com/343284_cbadd2f3b7cd42f3aced2d3f42dc6d33.html">this tutorial</a>
    (<a href="https://rpubs.com/dillmcfarlan/R_microbiotaSOP">alternative link</a>).
    </p>

    <br><br>

publications:

    -
        display-text: |
            phyloseq: An R package for reproducible interactive analysis and graphics of microbiome census data. Paul J. McMurdie and Susan Holmes (2013) PLoS ONE 8(4):e61217.
        link: |
            http://dx.plos.org/10.1371/journal.pone.0061217
